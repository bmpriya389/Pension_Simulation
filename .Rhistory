median_sgr<-0.0568
pop<-rep(1,71)
afc<-5
pop_type='Uniform'
pop_size=100000
ca=37
median=45
retire<-65
inflation=2
pop<-rep(1,71)
get_ARC(pop,ea,retire,median_p,median_dr,median_sgr,i,a_sgr,sgr,cola,afc,bf,cm,mort,vesting,amortization)
get_act_sal(ea,retire,a_sgr)
get_exp_sal(ea,retire,sgr)
get_acc_sal(ea,retire,a_sgr)
get_exp_sal_r(ea,retire,a_sgr,sgr)
get_mort(ea,retire,mort)
get_xpmx(ea,retire,mort)
get_acc_benefit_r(ea,retire,a_sgr,sgr,afc,bf)
get_acc_benefits(ea,retire,a_sgr,afc,bf)
get_xpmr(ea,retire,mort)
get_rpmx(ea,retire,mort)
get_xpmx(ea,retire,mort)
get_rxpxT(ea,retire,mort)
get_xpxT(ea,retire,mort)
get_qxt(ea,retire)
get_vxr(ea,retire,i)
get_vrx(ea,retire,i)
get_acc_benefit_65(ea,retire,a_sgr,sgr,afc,bf)
get_a_after_r(ea,retire,i,cola,mort)
get_tla_t(ea,retire,i,sgr,mort)
get_tla(ea,retire,i,sgr,mort,a)
get_am(ea,retire,i,amortization)
get_ar(ea,retire,i,cola,mort)
get_vesting_cost(ea,retire,i,a_sgr,cola,afc,bf,mort,vesting)
get_gxv(ea,retire,vesting)
get_xPVFBr(ea,retire,i,a_sgr,sgr,cola,afc,bf,mort)
get_rPVFBx(ea,retire,i,a_sgr,sgr,cola,afc,bf,mort)
get_term_cost(ea,retire,i,a_sgr,sgr,cola,afc,bf,mort,vesting)
get_PVTC_t(ea,retire,i,a_sgr,sgr,cola,afc,bf,mort,vesting)
get_PVTC(ea,retire,i,a_sgr,sgr,cola,afc,bf,mort,vesting,a)
get_AAL(ea,retire,i,a_sgr,sgr,cola,afc,bf,cm,mort,vesting)
get_aal_pop(pop,ea,retire,i,a_sgr,sgr,cola,afc,bf,cm,mort,vesting)
get_stat(ea,retire,active,retirees,median_p,median_dr,median_sgr,i,a_sgr,sgr,pgr,cola,afc,bf,cm,mort,vesting,amortization)
get_FR(pop,ea,retire,median_p,median_dr,median_sgr,i,a_sgr,sgr,cola,afc,bf,cm,mort,vesting)
get_median_asset(ea,retire,median_p,median_dr,median_sgr,a_sgr,cola,afc,bf,cm,mort,vesting)
get_nc_pop(pop,ea,retire,i,a_sgr,sgr,cola,afc,bf,cm,mort,vesting)
get_NC(ea,retire,i,a_sgr,sgr,cola,afc,bf,cm,mort,vesting)
active<-rep(1,(retire-ea+1))
retirees<-rep(1,(max_age-retire+1))
get_nc_pop(pop,ea,retire,i,a_sgr,sgr,cola,afc,bf,cm,mort,vesting)
get_stat(ea,retire,active,retirees,median_p,median_dr,median_sgr,i,a_sgr,sgr,pgr,cola,afc,bf,cm,mort,vesting,amortization)
active<-rep(1,36)
retirees<-rep(1,71)
get_stat(ea,retire,active,retirees,median_p,median_dr,median_sgr,i,a_sgr,sgr,pgr,cola,afc,bf,cm,mort,vesting,amortization)
pgr<-3.68
get_stat(ea,retire,active,retirees,median_p,median_dr,median_sgr,i,a_sgr,sgr,pgr,cola,afc,bf,cm,mort,vesting,amortization)
get_ARC(pop,ea,retire,median_p,median_dr,median_sgr,i,a_sgr,sgr,pgr,cola,afc,bf,cm,mort,vesting,amortization)
sum(get_ARC(pop,ea,retire,median_p,median_dr,median_sgr,i,a_sgr,sgr,pgr,cola,afc,bf,cm,mort,vesting,amortization))
shiny::runApp()
library(BayesBridge)
rm(list=ls())
source("functions.R")
###################### Load winklevoss and mortality tables #################################
load('E://SUNYALBANY/Pension_Simulation_Project/Code/Data/winklevossdata.RData')
load('E://SUNYALBANY/Pension_Simulation_Project/Code/Data/Mortality.RData')
######################### Parameters constant but likely to change ##########################
ea<-30
a_sgr<-0.05
sal=60000
sgr<-0.0568
mort<-2
afc<-5
bf<-0.02
i<-0.08
cola<-0.01
amortization<-30
vesting<-5
cm<-'EAN'
median_p<-0.854
median_dr<-0.08
median_sgr<-0.0568
pop<-rep(1,71)
afc<-5
pop_type='Uniform'
pop_size=100000
ca=37
median=45
retire<-65
inflation=2
pop<-rep(1,71)
get_act_sal(ea,retire,a_sgr)
get_acc_benefit_r(ea,retire,a_sgr,sgr,afc,bf)
3.5105/5.516
shiny::runApp()
library(BayesBridge)
rm(list=ls())
source("functions.R")
###################### Load winklevoss and mortality tables #################################
load('E://SUNYALBANY/Pension_Simulation_Project/Code/Data/winklevossdata.RData')
load('E://SUNYALBANY/Pension_Simulation_Project/Code/Data/Mortality.RData')
######################### Parameters constant but likely to change ##########################
ea<-30
sal=60000
sgr<-0.0568
a_sgr<-0.05
mort<-2
afc<-5
bf<-0.02
i<-0.08
amortization<-30
vesting<-5
median_p<-0.854
pop<-rep(1,71)
afc<-5
pop_type='Uniform'
ca=37
median=45
retire<-65
inflation=2
median_dr<-0.08
pop<-rep(1,71)
cola<-0.01
pop_size=100000
cm<-'EAN'
median_sgr<-0.0568
shiny::runApp()
ea<-30
ca<-36
ca-ea
ca-ea+1
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
library(BayesBridge)
rm(list=ls())
source("functions.R")
###################### Load winklevoss and mortality tables #################################
load('E://SUNYALBANY/Pension_Simulation_Project/Code/Data/winklevossdata.RData')
load('E://SUNYALBANY/Pension_Simulation_Project/Code/Data/Mortality.RData')
######################### Parameters constant but likely to change ##########################
ea<-30
a_sgr<-0.05
sal=60000
sgr<-0.0568
mort<-2
afc<-5
bf<-0.02
i<-0.08
cola<-0.01
amortization<-30
vesting<-5
cm<-'EAN'
median_p<-0.854
median_dr<-0.08
median_sgr<-0.0568
pop<-rep(1,71)
afc<-5
pop_type='Uniform'
pop_size=100000
ca=37
median=45
retire<-65
inflation=2
pop<-rep(1,71)
get_replacement_rate(ea,retire,a_sgr,sgr,afc,bf)
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
library(BayesBridge)
rm(list=ls())
source("functions.R")
###################### Load winklevoss and mortality tables #################################
load('E://SUNYALBANY/Pension_Simulation_Project/Code/Data/winklevossdata.RData')
load('E://SUNYALBANY/Pension_Simulation_Project/Code/Data/Mortality.RData')
######################### Parameters constant but likely to change ##########################
ea<-30
a_sgr<-0.05
sal=60000
sgr<-0.0568
mort<-2
afc<-5
bf<-0.02
i<-0.08
cola<-0.01
amortization<-30
vesting<-5
cm<-'EAN'
median_p<-0.854
median_dr<-0.08
median_sgr<-0.0568
pop<-rep(1,71)
afc<-5
pop_type='Uniform'
pop_size=100000
ca=37
median=45
retire<-65
inflation=2
pop<-rep(1,71)
acc_benefit_r<-get_acc_benefit_r(ea,retire,a_sgr,sgr,afc,bf)
acc_benefit_r
act_sal <- get_act_sal(ea,retire,a_sgr)
act_sal
repl_rate<-  acc_benefit_r/act_sal
repl_rate
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
library(BayesBridge)
rm(list=ls())
source("functions.R")
###################### Load winklevoss and mortality tables #################################
load('E://SUNYALBANY/Pension_Simulation_Project/Code/Data/winklevossdata.RData')
load('E://SUNYALBANY/Pension_Simulation_Project/Code/Data/Mortality.RData')
######################### Parameters constant but likely to change ##########################
ea<-30
a_sgr<-0.05
sal=60000
sgr<-0.0568
mort<-2
afc<-5
bf<-0.02
i<-0.08
cola<-0.01
amortization<-30
vesting<-5
cm<-'EAN'
median_p<-0.854
median_dr<-0.08
median_sgr<-0.0568
pop<-rep(1,71)
afc<-5
pop_type='Uniform'
pop_size=100000
ca=37
median=45
retire<-65
inflation=2
pop<-rep(1,71)
acc_benefit_r<-get_acc_benefit_r(ea,retire,a_sgr,sgr,afc,bf)
acc_benefit_r
acc_benefit_r[length(acc_benefit_r)]
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
library(BayesBridge)
rm(list=ls())
source("functions.R")
###################### Load winklevoss and mortality tables #################################
load('E://SUNYALBANY/Pension_Simulation_Project/Code/Data/winklevossdata.RData')
load('E://SUNYALBANY/Pension_Simulation_Project/Code/Data/Mortality.RData')
######################### Parameters constant but likely to change ##########################
ea<-30
a_sgr<-0.05
sal=60000
sgr<-0.0568
mort<-2
afc<-5
bf<-0.02
i<-0.08
cola<-0.01
amortization<-30
vesting<-5
cm<-'EAN'
median_p<-0.854
median_dr<-0.08
median_sgr<-0.0568
pop<-rep(1,71)
afc<-5
pop_type='Uniform'
pop_size=100000
ca=37
median=45
retire<-65
inflation=2
pop<-rep(1,71)
get_vxr(ea,retire,i)[length(get_vrx(ea,retire,i)):length(get_vxr(ea,retire,i))] *
c(get_rpmx(ea,retire,mort)[length(get_rpmx(ea,retire,mort))],get_xpmr(ea,retire,mort)) *
((1 + cola) ^ yos_r_max)
after_ar <-
rev(cumsum(rev(get_vxr(ea,retire,i)[length(get_vrx(ea,retire,i)):length(get_vxr(ea,retire,i))] *
c(get_rpmx(ea,retire,mort)[length(get_rpmx(ea,retire,mort))],get_xpmr(ea,retire,mort)) *
((1 + cola) ^ yos_r_max))))
after_ar
shiny::runApp()
10.0365*3.511
10.4733*3.511
shiny::runApp()
acc_benefit_r<-get_acc_benefit_r(ea,retire,a_sgr,sgr,afc,bf)
library(BayesBridge)
rm(list=ls())
source("functions.R")
###################### Load winklevoss and mortality tables #################################
load('E://SUNYALBANY/Pension_Simulation_Project/Code/Data/winklevossdata.RData')
load('E://SUNYALBANY/Pension_Simulation_Project/Code/Data/Mortality.RData')
######################### Parameters constant but likely to change ##########################
ea<-30
a_sgr<-0.05
sal=60000
sgr<-0.0568
mort<-2
afc<-5
bf<-0.02
i<-0.08
cola<-0.01
amortization<-30
vesting<-5
cm<-'EAN'
median_p<-0.854
median_dr<-0.08
median_sgr<-0.0568
pop<-rep(1,71)
afc<-5
pop_type='Uniform'
pop_size=100000
ca=37
median=45
retire<-65
inflation=2
pop<-rep(1,71)
acc_benefit_r<-get_acc_benefit_r(ea,retire,a_sgr,sgr,afc,bf)
act_sal <- get_act_sal(ea,retire,a_sgr)
repl_rate<- round((acc_benefit_r[length(acc_benefit_r)]/act_sal[length(act_sal)])*100,2)
repl_rate
acc_benefit<-get_acc_benefit_r(ea,retire,a_sgr,sgr,afc,bf)
acc_benefit
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
payroll<-c(get_act_sal(ea,retire,a_sgr)*active_pop,rep(0,length(c(active_pop,retire_pop))-length(active_pop)))
nc<-c(get_NC(ea,retire,i,a_sgr,sgr,cola,afc,bf,cm,mort,vesting)*active_pop,rep(0,length(c(active_pop,retire_pop))-length(active_pop)))
shiny::runApp()
library(BayesBridge)
rm(list=ls())
source("functions.R")
###################### Load winklevoss and mortality tables #################################
load('E://SUNYALBANY/Pension_Simulation_Project/Code/Data/winklevossdata.RData')
load('E://SUNYALBANY/Pension_Simulation_Project/Code/Data/Mortality.RData')
######################### Parameters constant but likely to change ##########################
ea<-30
a_sgr<-0.05
sal=60000
sgr<-0.0568
mort<-2
afc<-5
bf<-0.02
i<-0.08
cola<-0.01
amortization<-30
vesting<-5
cm<-'EAN'
median_p<-0.854
median_dr<-0.08
median_sgr<-0.0568
pop<-rep(1,71)
afc<-5
pop_type='Uniform'
pop_size=100000
ca=37
median=45
retire<-65
inflation=2
pop<-rep(1,71)
get_NC(ea,retire,i,a_sgr,sgr,cola,afc,bf,cm,mort,vesting)
get_nc_pop(pop,ea,retire,i,a_sgr,sgr,cola,afc,bf,cm,mort,vesting)
get_stat(ea,retire,active,retirees,i,a_sgr,sgr,cola,afc,bf,cm,mort,vesting)
active<-rep(1,36)
active<-rep(1,36)
retirees<-rep(1,35)
get_stat(ea,retire,active,retirees,i,a_sgr,sgr,cola,afc,bf,cm,mort,vesting)
library(BayesBridge)
rm(list=ls())
source("functions.R")
###################### Load winklevoss and mortality tables #################################
load('E://SUNYALBANY/Pension_Simulation_Project/Code/Data/winklevossdata.RData')
load('E://SUNYALBANY/Pension_Simulation_Project/Code/Data/Mortality.RData')
######################### Parameters constant but likely to change ##########################
ea<-30
a_sgr<-0.05
sal=60000
sgr<-0.0568
mort<-2
afc<-5
bf<-0.02
i<-0.08
cola<-0.01
amortization<-30
vesting<-5
cm<-'EAN'
median_p<-0.854
median_dr<-0.08
median_sgr<-0.0568
pop<-rep(1,71)
afc<-5
pop_type='Uniform'
pop_size=100000
ca=37
median=45
retire<-65
inflation=2
pop<-rep(1,71)
active<-rep(1,36)
retirees<-rep(1,35)
get_stat(ea,retire,active,retirees,i,a_sgr,sgr,cola,afc,bf,cm,mort,vesting)
library(BayesBridge)
rm(list=ls())
source("functions.R")
###################### Load winklevoss and mortality tables #################################
load('E://SUNYALBANY/Pension_Simulation_Project/Code/Data/winklevossdata.RData')
load('E://SUNYALBANY/Pension_Simulation_Project/Code/Data/Mortality.RData')
######################### Parameters constant but likely to change ##########################
ea<-30
a_sgr<-0.05
sal=60000
sgr<-0.0568
mort<-2
afc<-5
bf<-0.02
i<-0.08
cola<-0.01
amortization<-30
vesting<-5
cm<-'EAN'
median_p<-0.854
median_dr<-0.08
median_sgr<-0.0568
pop<-rep(1,71)
afc<-5
pop_type='Uniform'
pop_size=100000
ca=37
median=45
retire<-65
inflation=2
pop<-rep(1,71)
active<-rep(1,36)
active_pop<-active
retire_pop<-retirees%>%table()
retirees<-rep(1,35)
retire_pop<-retirees%>%table()
active_pop<-table(active_pop)
payroll<-c(get_act_sal(ea,retire,a_sgr)*active_pop,rep(0,length(c(active_pop,retire_pop))-length(active_pop)))
payroll
active_pop
retire_pop
active<-seq(30,65)
retirees<-rep(66,100)
active_pop<-active
retire_pop<-retirees%>%table()
active_pop<-table(active_pop)
retire_pop
active_pop
retire_pop
retirees<-seq(66,100)
retire_pop<-retirees%>%table()
active_pop<-table(active_pop)
retire_pop
active_pop
active<-seq(30,65)
active_pop<-active
active_pop
active_pop<-table(active_pop)
active_pop
retire_pop
payroll<-c(get_act_sal(ea,retire,a_sgr)*active_pop,rep(0,length(c(active_pop,retire_pop))-length(active_pop)))
payroll
length(payroll)
nc<-c(get_NC(ea,retire,i,a_sgr,sgr,cola,afc,bf,cm,mort,vesting)*active_pop,rep(0,length(c(active_pop,retire_pop))-length(active_pop)))
nc
length(nc)
aal<-c(active_pop,retire_pop)*get_AAL(ea,retire,i,a_sgr,sgr,cola,afc,bf,cm,mort,vesting)
aal
dat<-data.frame(Age=seq(ea,max_age),Payroll=payroll,"Normal Cost"=nc,AAL=aal)
dat
total_payroll<-sum(payroll)
total_nc<-sum(nc)
total_aal<-sum(aal)
stat<-split(dat,cut(dat$Age,age_grp_labels(ea,retire,max_age),include.lowest = TRUE))
stats<-NULL
stat
for(j in 1:length(stat)){
stats<-rbind(stats,data.frame(names(stat)[j],
(sum(stat[[j]]$Payroll)/total_payroll)*100,
(sum(stat[[j]]$Normal.Cost)/total_nc)*100,
(sum(stat[[j]]$AAL)/total_aal)*100))
}
names(stats)<-c("Age Group","Salary/Total Salary (%)","Normal Cost/Total Normal Cost (%)","AAL/Total AAL (%)")
stats
get_stat(ea,retire,active,retirees,i,a_sgr,sgr,cola,afc,bf,cm,mort,vesting)
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
